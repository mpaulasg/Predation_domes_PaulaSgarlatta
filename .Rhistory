mutate(log_attack = log10(attack + 1))
attack_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the transect by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T))%>%
#Try with binomial data and log data
attack <- attack %>%
mutate(binary=ifelse(attack >0, 1, 0)) %>%
mutate(log_attack = log10(attack + 1))
attack_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the transect by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T))
View(attack_2)
View(attack_species)
attack_binary <- attack_2 %>%
mutate(binary=ifelse(attack >0, 1, 0)) %>%
mutate(log_attack = log10(attack + 1))
attack_domes <- glmmTMB (attack  ~ Area + (1|Site)+ (1|Replicate), data=attack_2,
family = poisson(link="log"))
Anova(attack_domes) # The interaction is working p=0.0002286
attack_res_domes <- simulateResiduals(attack_domes)
plot(attack_res_domes)
testDispersion(attack_res_domes) #Good enough
attack_domes <- glmmTMB (attack  ~ Area + (1|Site)+ (1|Replicate), data=attack_binary,
family = poisson(link="log"))
Anova(attack_domes) # The interaction is working p=0.0002286
attack_domes <- glmmTMB (attack  ~ Area + (1|Site), data=attack_2,
family = poisson(link="log"))
Anova(attack_domes) # p=0.19, which is surprising?
attack_domes <- glmmTMB (attack  ~ Area + (1|Site) + (1|Replicate) + (1| Time), data=attack_2,
family = poisson(link="log"))
Anova(attack_domes) # p=0.19, which is surprising?
attack_domes <- glmmTMB (attack  ~ Area + (1|Site/Replicate), data=attack_2,
family = poisson(link="log"))
Anova(attack_domes) # p=0.19, which is surprising?
ggplot(attack_2, aes(Area, attack, colour = Site))+geom_jitter()
ggplot(attack_2, aes(Area, attack))+geom_jitter()
ggplot(attack_2, aes(Area, attack))+boxplot() + geom_jitter()
ggplot(attack_2) + boxplot(aes(Area, attack)) + geom_jitter()
boxplot(attack ~ Area, data=attack_2)) + geom_jitter()
boxplot(attack ~ Area, data=attack_2) + geom_jitter()
View(attack_2)
inspecting_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T))
boxplot(attack ~ Area, data=inspecting_2) + geom_jitter()
boxplot(inspecting ~ Area, data=inspecting_2) + geom_jitter()
inspect_domes <- glmmTMB (inspecting ~ Area + (1|Site) + (1|Replicate), data=inspecting_2,
family = poisson(link = "log"))
Anova(inspect_domes) #Significant - p=0.00010
inspec_res_domes <- simulateResiduals(inspect_domes)
plot(inspec_res_domes) # Good!
data_squid <- data %>%
dplyr:: filter (Area != "Lizard Island",
Site != "Malabar 1 ",
Treatment != "No_fish") %>%
dplyr::select(-Treatment)
View(data_squid)
attack_2_squid <- data_squid %>%
dplyr::group_by(Method,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T))
inspecting_2_squid <- data_squid %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T))
attack_domes <- glmmTMB (attack  ~ Method + (1|Site) (1|Replicate), data=attack_2,
family = poisson(link="log"))
attack_domes <- glmmTMB (attack  ~ Method + (1|Site) (1|Replicate), data=attack_2_squid,
family = poisson(link="log"))
Anova(attack_domes) # p=0.19, which is surprising?
data_squid$Site <- factor(data_squid$Site)
attack_2_squid <- data_squid %>%
dplyr::group_by(Method,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T))
inspecting_2_squid <- data_squid %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T))
attack_domes <- glmmTMB (attack  ~ Method + (1|Site) (1|Replicate), data=attack_2_squid,
family = poisson(link="log"))
attack_squid <- glmmTMB (attack  ~ Method + (1|Site) + (1|Replicate), data=attack_2_squid,
family = poisson(link="log"))
Anova(attack_domes) # p=0.19, which is surprising?
data_squid <- data %>%
dplyr:: filter (Area != "Lizard Island",
Site != "Malabar 1 ",
Treatment != "No_fish") %>%
dplyr::select(-Treatment)
attack_2_squid <- data_squid %>%
dplyr::group_by(Method,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T))
inspecting_2_squid <- data_squid %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T))
attack_squid <- glmmTMB (attack  ~ Method + (1|Site) + (1|Replicate), data=attack_2_squid,
family = poisson(link="log"))
Anova(attack_domes) # p=0.19, which is surprising?
Anova(attack_squid) # p=0.28, which is surprising?
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) #Good
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) #Good
testDispersion(attack_res_squid)
bartlett.test(attack  ~ Method, data=attack_2_squid)
inspect_squid <- glmmTMB (inspecting ~ Area + (1|Site) + (1|Replicate), data=inspecting_2_squid,
family = poisson(link = "log"))
Anova(inspect_squid) #Significant - p=0.4 - this is surprising?
View(inspecting_2_squid)
View(attack_2_squid)
inspecting_2_squid <- data_squid %>%
dplyr::group_by(Method, Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T))
inspect_squid <- glmmTMB (inspecting ~ Method + (1|Site) + (1|Replicate), data=inspecting_2_squid,
family = poisson(link = "log"))
Anova(inspect_squid) #Significant - p=0.4 - this is surprising?
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good!
testDispersion(inspec_res_squid) # this one looks good
bartlett.test(inspecting ~ Method, data=inspecting_2_squid)#Good kinda
View(attack_2)
View(data_domes)
attack <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time, Trophic.group)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T))
View(attack)
inspecting_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time, Trophic.group)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T))
piscivores <- attack %>%
filter(Trophic.group == "Piscivore")
pisc <- glmmTMB (attack ~ Area + (1|Site) + (1|Replicate), data=piscivores,
family = poisson(link = "log"))
summary(pisc)
Anova(pisc) #p=0.0003991
pis_res_domes <- simulateResiduals(pisc)
plot(pis_res_domes) # Good!
Omnivore <- attack %>%
filter(Trophic.group == "Omnivore")
omn <- glmmTMB(attack  ~ Area + (1|Site) + (1|Replicate),  data = Omnivore,
family = ziGamma(link = "log"), ziformula =~1)
Anova(omn) #Cannot run the model, the model doesn't fit.
omn <- glmmTMB(attack  ~ Area + (1|Site) + (1|Replicate),  data = Omnivore,
family = poisson(link = "log"))
Anova(omn) #Cannot run the model, the model doesn't fit.
Herbivore <- attack %>%
filter(Trophic.group == "Herbivore")
herb <- glmmTMB(attack ~ Area + (1|Site) + (1|Replicate), data=Herbivore,
family= poisson(link = "log"))
data_squid <- data %>%
dplyr:: filter (Area != "Lizard Island",
Site != "Malabar 1 ",
Treatment != "No_fish") %>%
dplyr::select(-Treatment)
attack_2_squid <- data_squid %>%
dplyr::group_by(Method,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T))
inspecting_2_squid <- data_squid %>%
dplyr::group_by(Method, Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T))
attack_squid <- glmmTMB (attack  ~ Method + (1|Site) + (1|Replicate), data=attack_2_squid,
family = poisson(link="log"))
Anova(attack_squid) # p<0.001
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) #This one no working
testDispersion(attack_res_squid) # this one looks good
bartlett.test(attack  ~ Method, data=attack_2_squid)#Good kinda
inspect_squid <- glmmTMB (inspecting ~ Method + (1|Site) + (1|Replicate), data=inspecting_2_squid,
family = poisson(link = "log"))
Anova(inspect_squid) #Significant - p=0.048*
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Not enough points I guess
testDispersion(inspec_res_squid) # this one looks good
bartlett.test(inspecting ~ Method, data=inspecting_2_squid)#Good
piscivores_inv <- inspecting_2 %>%
filter(Trophic.group == "Piscivore")
pisc_inv <- glmmTMB(inspecting ~ Area + (1|Site) + (1|Replicate), data=piscivores_inv,
family = poisson(link = "log"))
summary(pisc_inv)
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) # Good!
testDispersion(pisc_inv_res_domes) # this one looks good
bartlett.test(inspecting ~ Area, data=piscivores_inv)#Good kinda
pisc_inv <- glmmTMB(log(inspecting + 1) ~ Area + (1|Site) + (1|Replicate), data=piscivores_inv,
family = poisson())
summary(pisc_inv)
Anova(pisc_inv) #Significant - p=0.02
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) # Not enough points I guess
testDispersion(pisc_inv_res_domes) # this one looks good
bartlett.test(inspecting ~ Area, data=piscivores_inv)#Not good
pisc_inv <- glmmTMB(log(inspecting + 1) ~ Area + (1|Site) + (1|Replicate), data=piscivores_inv,
family = poisson(link = "log"))
summary(pisc_inv)
Anova(pisc_inv) #Significant - p=0.02
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) # Not enough points I guess
testDispersion(pisc_inv_res_domes) # this one looks good
pisc_inv <- glmmTMB(inspecting ~ Area + (1|Site) + (1|Replicate), data=piscivores_inv,
family = ziGamma(link = "log"), ziformula = ~1)
summary(pisc_inv)
Anova(pisc_inv) #Significant - p=0.02
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) # Not enough points I guess
testDispersion(pisc_inv_res_domes) # this one looks good
bartlett.test(inspecting ~ Area, data=piscivores_inv)#Not good
pisc_inv <- glmmTMB(inspecting ~ Area + (1|Site) + (1|Replicate), data=piscivores_inv,
family = tweedie(link = "log"))
summary(pisc_inv)
Anova(pisc_inv) #Significant - p=0.02
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) # Not enough points I guess
testDispersion(pisc_inv_res_domes) # this one looks good
bartlett.test(inspecting ~ Area, data=piscivores_inv)#Not good
pisc_inv <- glmmTMB(log(inspecting + 1) ~ Area + (1|Site) + (1|Replicate), data=piscivores_inv,
family = tweedie(link = "log"))
summary(pisc_inv)
Anova(pisc_inv) #Significant - p=0.02
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) # Not enough points I guess
testDispersion(pisc_inv_res_domes) # this one looks good
bartlett.test(inspecting ~ Area, data=piscivores_inv)#Not good
pisc_inv <- lmer(log(inspecting + 1) ~ Area + (1|Site) + (1|Replicate), data=piscivores_inv,
family = tweedie(link = "log"))
pisc_inv <- lmer(log(inspecting + 1) ~ Area + (1|Site) + (1|Replicate), data=piscivores_inv)
summary(pisc_inv)
Anova(pisc_inv) #Significant - p=0.02
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) # Not enough points I guess
testDispersion(pisc_inv_res_domes) # this one looks good
bartlett.test(inspecting ~ Area, data=piscivores_inv)#Not good
View(piscivores_inv)
friedman.test(inspecting ~ Area|Site, data=piscivores_inv)
friedman.test(inspecting ~ Area, data=piscivores_inv)
friedman.test(inspecting ~ Site|Area, data=piscivores_inv)
pisc_lizard <- piscivores_inv %>%
filter(Area =="Lizard Island")
pisc_sydney <- piscivores_inv %>%
filter(Area =="Sydney")
wilcox.test(pisc_lizard$inspecting, pisc_sydney$inspecting, paired = TRUE)
View(inspecting_2)
attack_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Area nesting(Site,Replicate,Time),fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
attack_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Area, nesting(Site,Replicate,Time),fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
View(attack_2)
View(attack)
attack_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Area),fill= list(attack=0) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
attack_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Area, fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
inspecting_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Area, fill= list(inspecting=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
boxplot(attack ~ Area, data=attack_2) + geom_jitter()
boxplot(inspecting ~ Area, data=inspecting_2) + geom_jitter()
attack_domes <- glmmTMB (attack  ~ Area + (1|Site) + (1|Replicate), data=attack_2,
family = poisson(link="log"))
Anova(attack_domes) # p=0.19, which is surprising?
attack_res_domes <- simulateResiduals(attack_domes)
plot(attack_res_domes) #Good
testDispersion(attack_res_domes)
inspect_domes <- glmmTMB (inspecting ~ Area + (1|Site) + (1|Replicate), data=inspecting_2,
family = poisson(link = "log"))
Anova(inspect_domes) #Significant - p=0.4 - this is surprising?
inspec_res_domes <- simulateResiduals(inspect_domes)
plot(inspec_res_domes) # Good!
attack <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time, Trophic.group)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T))
attack <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time, Trophic.group)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Trophic.group, nested(Area,Area,Site, Replicate,Time), fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
attack <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time, Trophic.group)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Area,Area,Site, Replicate,Time), fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
attack <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time, Trophic.group)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Area,Site, Replicate,Time), fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
inspecting_2 <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time, Trophic.group)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Area,Site, Replicate,Time), fill= list(inspecting=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
piscivores <- attack %>%
filter(Trophic.group == "Piscivore")
pisc <- glmmTMB (attack ~ Area + (1|Site) + (1|Replicate), data=piscivores,
family = poisson(link = "log"))
Anova(pisc) #p=0.0003991
pis_res_domes <- simulateResiduals(pisc)
plot(pis_res_domes) # Good!
Omnivore <- attack %>%
filter(Trophic.group == "Omnivore")
omn <- glmmTMB(attack  ~ Area + (1|Site) + (1|Replicate),  data = Omnivore,
family = poisson(link = "log"))
Anova(omn) #Cannot run the model, the model doesn't fit. I guess the model doesn't fit because there are not
Herbivore <- attack %>%
filter(Trophic.group == "Herbivore")
herb <- glmmTMB(attack ~ Area + (1|Site) + (1|Replicate), data=Herbivore,
family= poisson(link = "log"))
Anova(herb)#Cannot run the model, the model doesn't fit. I guess the model doesn't fit because there are not
piscivores_inv <- inspecting_2 %>%
filter(Trophic.group == "Piscivore")
pisc_inv <- glmmTMB(log(inspecting + 1) ~ Area + (1|Site) + (1|Replicate), data=piscivores_inv,
family = tweedie(link = "log"))
summary(pisc_inv)
Anova(pisc_inv) #Significant - p=0.02
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) # Not enough points I guess
testDispersion(pisc_inv_res_domes) # this one looks good
bartlett.test(inspecting ~ Area, data=piscivores_inv)#Not good
plot(pisc_inv_res_domes) # Perfect
Omnivore_inv <- inspecting %>%
filter(Trophic.group == "Omnivore")
Omnivore_inv <- inspecting_2 %>%
filter(Trophic.group == "Omnivore")
omn_inv <- glmmTMB(inspecting ~ Area + (1|Site) + (1|Replicate), data=Omnivore_inv,
family = poisson(link = "log"))
summary(omn_inv)
Anova(omn_inv)
omn_inv <- glmmTMB(log(inspecting + 1) ~ Area + (1|Site) + (1|Replicate), data=Omnivore_inv,
family = poisson(link = "log"))
summary(omn_inv)
Anova(omn_inv)
Herbivore_inv <- inspecting %>%
filter(Trophic.group == "Herbivore")
Herbivore_inv <- inspecting_2 %>%
filter(Trophic.group == "Herbivore")
herb_inv <- glmmTMB(inspecting ~ Area + (1|Site) + (1|Replicate), data=Herbivore_inv,
family = poisson(link = "log"))
summary(herb_inv)
Anova(herb_inv)
planktivore_inv <- inspecting_2 %>%
filter(Trophic.group == "Planktivore")
plank_inv <- glmmTMB(inspecting ~ Area + (1|Site) + (1|Replicate), data=planktivore_inv,
family = poisson(link = "log"))
summary(plank_inv)
Anova(plank_inv)
plank_inv_res_domes <- simulateResiduals(plank_inv)
plot(plank_inv_res_domes) # Good!
data_squid <- data %>%
dplyr:: filter (Area != "Lizard Island",
Site != "Malabar 1 ",
Treatment != "No_fish") %>%
dplyr::select(-Treatment)
attack_2_squid <- data_squid %>%
dplyr::group_by(Method,Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Method, fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
inspecting_2_squid <- data_squid %>%
dplyr::group_by(Method, Site, Replicate,Time)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Method, fill= list(inspecting=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
attack_squid <- glmmTMB (attack  ~ Method + (1|Site) + (1|Replicate), data=attack_2_squid,
family = poisson(link="log"))
Anova(attack_squid) # p<0.001
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) #This one no working
testDispersion(attack_res_squid) # this one looks good
bartlett.test(attack  ~ Method, data=attack_2_squid)#Good kinda
inspect_squid <- glmmTMB (inspecting ~ Method + (1|Site) + (1|Replicate), data=inspecting_2_squid,
family = poisson(link = "log"))
Anova(inspect_squid) # ~ no significant - p=0.048*
inspect_squid <- glmmTMB (log(inspecting + 1) ~ Method + (1|Site) + (1|Replicate), data=inspecting_2_squid,
family = poisson(link = "log"))
Anova(inspect_squid) # ~ no significant - p=0.048*
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Not enough points I guess
testDispersion(inspec_res_squid) # this one looks good
bartlett.test(inspecting ~ Method, data=inspecting_2_squid)#Good
attack_squid_2 <- data_squid %>%
dplyr::group_by(Method,Site, Replicate,Time, Trophic.group)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Method,Site, Replicate,Time), fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
inspecting_squid_2 <- data_squid %>%
dplyr::group_by(Method,Site, Replicate,Time, Trophic.group)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Method,Site, Replicate,Time), fill= list(inspecting=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
piscivores_squid <- attack_squid_2 %>%
filter(Trophic.group == "Piscivore")
pisc_squid <- glmmTMB (attack ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid,
family = poisson(link = "log"))
Anova( pisc_squid) #p=0.0003991
View(piscivores_squid)
Omnivore_squid_squid <- attack_squid_2 %>%
filter(Trophic.group == "Omnivore")
omn <- glmmTMB(attack  ~ Method + (1|Site) + (1|Replicate),  data = Omnivore_squid,
family = poisson(link = "log"))
Omnivore_squid <- attack_squid_2 %>%
filter(Trophic.group == "Omnivore")
omn <- glmmTMB(attack  ~ Method + (1|Site) + (1|Replicate),  data = Omnivore_squid,
family = poisson(link = "log"))
Anova(omn) #Cannot run the model, the model doesn't fit. I guess the model doesn't fit because there are not
omn_squid <- glmmTMB(attack  ~ Method + (1|Site) + (1|Replicate),  data = Omnivore_squid,
family = poisson(link = "log"))
omn_attack_res_squid <- simulateResiduals(omn_squid)
plot(omn_attack_res_squid) # Perfect
testDispersion(omn_attack_res_squid) # this one looks good
bartlett.test(attack  ~ Method , data=Omnivore_squid)#Good
Herbivore_squid <- attack_squid_2 %>%
filter(Trophic.group == "Herbivore")
View(attack_squid_2)
herb <- glmmTMB(attack ~ Method + (1|Site) + (1|Replicate), data=Herbivore_squid,
family= poisson(link = "log"))
Anova(herb)#Cannot run the model, the model doesn't fit. I guess the model doesn't fit because there are not
piscivores_squid_inv <- inspecting_squid_2 %>%
filter(Trophic.group == "Piscivore")
pisc_squid_inv <- glmmTMB(inspecting + 1 ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid_inv,
family = tweedie(link = "log"))
Anova(pisc_squid_inv) #Significant - p=0.002
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
Anova(pisc_squid_inv) #Significant - p=0.002
pisc_squid_inv <- glmmTMB(inspecting + 1 ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid_inv,
family = tweedie(link = "log"))
pisc_squid_inv <- glmmTMB(inspecting + 1 ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid_inv,
family = poisson(link = "log"))
Anova(pisc_squid_inv) #Significant - p=0.002
View(piscivores_squid_inv)
pisc_squid_inv_res <- simulateResiduals(pisc_squid_inv)
plot(pisc_squid_inv_res) # Perfect
testDispersion(pisc_squid_inv_res) # this one looks good
pisc_squid_inv <- glmmTMB(log(inspecting + 1) ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid_inv,
family = poisson(link = "log"))
Anova(pisc_squid_inv) #No Significant - p=0.6797
pisc_squid_inv <- glmmTMB(log(inspecting + 1) ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid_inv,
family = poisson())
Anova(pisc_squid_inv) #No Significant - p=0.6797
pisc_squid_inv <- glmmTMB(log(inspecting + 1) ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid_inv,
family = ziGamma())
pisc_squid_inv <- glmmTMB(log(inspecting + 1) ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid_inv,
family = ziGamma(link = "log"))
pisc_squid_inv <- glmmTMB(log(inspecting + 1) ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid_inv,
family = ziGamma(link = "log"), ziformula = ~1)
Anova(pisc_squid_inv) #No Significant - p=0.6797
pisc_squid_inv <- glmmTMB(inspecting  ~ Method + (1|Site) + (1|Replicate), data=piscivores_squid_inv,
family = poisson(link="log"))
Anova(pisc_squid_inv) #No Significant - p=0.6797
Omnivore_inv <- inspecting_squid_2 %>%
filter(Trophic.group == "Omnivore")
Omnivore_inv <- inspecting_squid_2 %>%
filter(Trophic.group == "Omnivore")
omn_squid_inv <- glmmTMB(log(inspecting + 1) ~ Method + (1|Site) + (1|Replicate), data=Omnivore_inv,
family = poisson(link = "log"))
Anova(omn_inv)#Cannot run the model, the model doesn't fit. I guess the model doesn't fit because there are not
View(Omnivore_inv)
Herbivore_inv <- inspecting_squid_2 %>%
filter(Trophic.group == "Herbivore")
herb_inv <- glmmTMB(inspecting ~ Method + (1|Site) + (1|Replicate), data=Herbivore_inv,
family = poisson(link = "log"))
View(inspecting_squid_2)
planktivore_inv <- inspecting_squid_2 %>%
filter(Trophic.group == "Planktivore")
plank_inv <- glmmTMB(inspecting ~ Method + (1|Site) + (1|Replicate), data=planktivore_inv,
family = poisson(link = "log"))
Anova(plank_inv) # p=0.63
View(planktivore_inv)
plank_inv <- glmmTMB(inspecting ~ Method + (1|Site) + (1|Replicate), data=planktivore_inv,
family = poisson(link = "log"))
plank_inv <- glmmTMB(log(inspecting + 1) ~ Method + (1|Site) + (1|Replicate), data=planktivore_inv,
family = poisson(link = "log"))
Anova(plank_inv) # p=0.63
plank_inv_res_squid <- simulateResiduals(plank_inv)
plot(plank_inv_res_squid) # Good!
testDispersion(plank_inv_res_squid) # this one looks good
bartlett.test(inspecting  ~ Method , data=planktivore_inv)#Good
bartlett.test(log(inspecting + 1)  ~ Method , data=planktivore_inv)#Good
