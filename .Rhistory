attack_res_domes <- simulateResiduals(mod1)
plot(attack_res_domes) #Poisson is the best one but still not great
mod1 <- glmmTMB (attack ~ Area + offset (total_video_min),
data=attack_number, family = nbinom2())
summary(mod1)
Anova(mod1) #
attack_res_domes <- simulateResiduals(mod1)
plot(attack_res_domes) #Poisson is the best one but still not great
mod1 <- glmmTMB (attack ~ Area + Site + offset (total_video_min),
data=attack_number, family = nbinom2())
summary(mod1)
mod1 <- glmmTMB (attack ~ Area + Site + offset (log(total_video_min)),
data=attack_number, family = nbinom2())
summary(mod1)
Anova(mod1) #
mod1 <- glmmTMB (attack ~ Area + (1|Site) + offset (log(total_video_min)),
data=attack_number, family = nbinom2())
summary(mod1)
Anova(mod1) #
attack_res_domes <- simulateResiduals(mod1)
plot(attack_res_domes) #Poisson is the best one but still not great
mod1 <- glmmTMB (attack ~ Area + Site + offset (log(total_video_min)),
data=attack_number, family = nbinom2())
summary(mod1)
Anova(mod1) #
attack_res_domes <- simulateResiduals(mod1)
plot(attack_res_domes) #Poisson is the best one but still not great
mod1 <- glmmTMB (attack ~ Area + offset (log(total_video_min)),
data=attack_number, family = nbinom2())
summary(mod1)
Anova(mod1) #
attack_res_domes <- simulateResiduals(mod1)
plot(attack_res_domes) #Poisson is the best one but still not great
mod1 <- glmmTMB (attack   ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=attack_number, family = poisson())
summary(mod1)
Anova(mod1) #
attack_res_domes <- simulateResiduals(mod1)
plot(attack_res_domes) #Poisson is the best one but still not great
View(attack_number)
mod1 <- glmmTMB (attack   ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=attack_number, family = poisson())
summary(mod1)
Anova(mod1) # p=0.28
attack_res_domes <- simulateResiduals(mod1)
plot(attack_res_domes) #Good
mod2 <- glmmTMB (inspecting ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=inspecting_number, family = nbinom2())
inspecting_number <- data_domes %>%
dplyr::group_by(Area,Site,rep_ID,Time, total_video_min)%>%
dplyr::summarise(inspecting=sum(inspecting_number,na.rm=T))
mod2 <- glmmTMB (inspecting ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=inspecting_number, family = nbinom2())
summary(mod2)
Anova(mod2)
attack_res_domes_mod2 <- simulateResiduals(mod2)
plot(attack_res_domes_mod2) # Residuals look terrible...
mod2 <- glmmTMB (inspecting ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=inspecting_number, family = poisson ())
summary(mod2)
Anova(mod2)
attack_res_domes_mod2 <- simulateResiduals(mod2)
plot(attack_res_domes_mod2) # Good
mod2 <- glmmTMB (inspecting ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=inspecting_number, family = nbinom1 ())
summary(mod2)
Anova(mod2)
attack_res_domes_mod2 <- simulateResiduals(mod2)
plot(attack_res_domes_mod2) # Good
mod2 <- glmmTMB (inspecting ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=inspecting_number, family = nbinom2 ())
summary(mod2)
Anova(mod2)
attack_res_domes_mod2 <- simulateResiduals(mod2)
plot(attack_res_domes_mod2) # Good
attack_total <- data_domes %>%
dplyr::group_by(Area,Site, rep_ID,Time, total_video_min, Trophic.group)%>%
dplyr::summarise(attack=sum(attack_number,na.rm=T))%>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Area, Site, rep_ID,Time, total_video_min),fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
piscivores <- attack_total %>%
filter(Trophic.group == "Piscivore")
pisc <- glmmTMB (attack ~ Area + (1|Site)+ (1|rep_ID) + offset (log(total_video_min)),
data=piscivores,
family = nbinom1())
Anova(pisc) #p=0.16
pis_res_domes <- simulateResiduals(pisc)
plot(pis_res_domes) # I think is good?? - If this is correct, it changes our results
pisc <- glmmTMB (attack ~ Area + (1|Site)+ (1|rep_ID) + offset (log(total_video_min)),
data=piscivores, zi=~1,
family = nbinom1())
Anova(pisc) #p=0.16
pis_res_domes <- simulateResiduals(pisc)
plot(pis_res_domes) # I think is good?? - If this is correct, it changes our results
View(piscivores)
pisc <- glmmTMB (attack ~ Area + (1|Site)+ (1|rep_ID) + offset (log(total_video_min)),
data=piscivores,
family = poisson())
Anova(pisc) #p=0.03
pis_res_domes <- simulateResiduals(pisc)
plot(pis_res_domes) # Good
mod2 <- glmmTMB (inspecting ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=inspecting_number, family = nbinom2 ())
summary(mod2)
Anova(mod2)
attack_res_domes_mod2 <- simulateResiduals(mod2)
plot(attack_res_domes_mod2) # Good
pisc <- glmmTMB (attack ~ Area + (1|Site)+ (1|rep_ID) + offset (log(total_video_min)),
data=piscivores,
family = poisson())
Anova(pisc) #p=0.03
pis_res_domes <- simulateResiduals(pisc)
plot(pis_res_domes) # Good
inspect_total <- data_domes %>%
dplyr::group_by(Area,Site, rep_ID,Time, total_video_min, Trophic.group)%>%
dplyr::summarise(inspect=sum(inspecting_number,na.rm=T))%>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Area, Site, rep_ID,Time, total_video_min),fill= list(inspect=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
piscivores_inv <- inspect_total %>%
filter(Trophic.group == "Piscivore")
pisc_inv <- glmmTMB(inspect  ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=piscivores_inv,
family = poisson())
summary(pisc_inv)
Anova(pisc_inv)
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) #Nbinom1 best one, but still bad
planktivore_inv <- inspect_total %>%
filter(Trophic.group == "Planktivore")
plank_inv <- glmmTMB(inspect ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)), data=planktivore_inv,
family = nbinom1())
Anova(plank_inv) # p=0.653
plank_inv_res_domes <- simulateResiduals(plank_inv)
plot(plank_inv_res_domes) # Good!
plank_inv <- glmmTMB(inspect ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)), data=planktivore_inv,
family = poisson())
Anova(plank_inv) # p=0.653
plank_inv_res_domes <- simulateResiduals(plank_inv)
plot(plank_inv_res_domes) # Good!
plank_inv <- glmmTMB(inspect ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)), data=planktivore_inv,
family = nbinom1())
Anova(plank_inv) # p=0.653
plank_inv_res_domes <- simulateResiduals(plank_inv)
plot(plank_inv_res_domes) # Good!
data_squid <- data %>%
dplyr:: filter (Area != "Lizard Island",
Site != "Malabar 1 ",
Treatment != "No_fish") %>%
dplyr::select(-Treatment)
data_squid <- unite(data_squid, rep_ID, c("Site", "Replicate", "Time"), sep = "_", remove = FALSE)
attack_number_squid <- data_squid %>%
dplyr::group_by(Method, Area,Site, rep_ID,Time, total_video_min)%>%
dplyr::summarise(attack=sum(attack_number,na.rm=T))
inspecting_number_squid <- data_squid %>%
dplyr::group_by(Method, Area,Site,rep_ID,Time, total_video_min)%>%
dplyr::summarise(inspecting=sum(inspecting_number,na.rm=T))
attack_squid <- glmmTMB (attack   ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)), data=attack_number_squid,
family = nbinom1())
summary(attack_squid)
Anova(attack_squid) # method - p<0.00002
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) # Good
attack_squid <- glmmTMB (attack   ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)), data=attack_number_squid,
family = poisson())
summary(attack_squid)
Anova(attack_squid) # method - p<0.00002
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) # Good
attack_squid <- glmmTMB (attack   ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min), data=attack_number_squid,
family = poisson())
summary(attack_squid)
Anova(attack_squid) # method - p<0.00002
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) # Good
attack_squid <- glmmTMB (attack   ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min), data=attack_number_squid,
family = nbinom1())
summary(attack_squid)
Anova(attack_squid) # method - p<0.00002
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) # Good
inspect_squid <- glmmTMB (inspecting    ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min),
data= inspecting_number_squid,
family = poisson())
Anova(inspect_squid) # p=0.53
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good(ish)
inspect_squid <- glmmTMB (inspecting    ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min),
data= inspecting_number_squid,
family = nbinom1())
Anova(inspect_squid) # p=0.53
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good(ish)
inspect_squid <- glmmTMB (inspecting    ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min),
data= inspecting_number_squid,
family = nbinom2())
Anova(inspect_squid) # p=0.53
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good(ish)
inspect_squid <- glmmTMB (inspecting    ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data= inspecting_number_squid,
family = nbinom2())
Anova(inspect_squid) # p=0.53
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good(ish)
inspect_squid <- glmmTMB (inspecting    ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data= inspecting_number_squid,
family = poisson())
Anova(inspect_squid) # p=0.53
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good(ish)
attack_squid <- glmmTMB (attack   ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)), data=attack_number_squid,
family = poisson())
summary(attack_squid)
Anova(attack_squid) # method - p<0.00002
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) # Good
inspect_squid <- glmmTMB (inspecting    ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min),
data= inspecting_number_squid,
family = poisson())
Anova(inspect_squid) # p=0.53
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good
inspect_squid <- glmmTMB (inspecting    ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min),
data= inspecting_number_squid,
family = nbinom1())
Anova(inspect_squid) # p=0.53
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good
i
i
inspect_squid <- glmmTMB (inspecting    ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min),
data= inspecting_number_squid,
family = nbinom2())
Anova(inspect_squid) # p=0.53
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good
attack_squid <- glmmTMB (attack   ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)), data=attack_number_squid,
family = poisson())
summary(attack_squid)
Anova(attack_squid) # method - p<0.00002
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) # Good
attack_squid <- glmmTMB (attack   ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min), data=attack_number_squid,
family = poisson())
summary(attack_squid)
Anova(attack_squid) # method - p<0.00002
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) # Good
attack_squid <- glmmTMB (attack   ~ Method + (1|Site) + (1|rep_ID) + offset (total_video_min), data=attack_number_squid,
family = nbinom1())
summary(attack_squid)
Anova(attack_squid) # method - p<0.00002
attack_res_squid <- simulateResiduals(attack_squid)
plot(attack_res_squid) # Good
inspect_squid <- glmmTMB (inspecting    ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data= inspecting_number_squid,
family = poisson())
Anova(inspect_squid) # p=0.53
inspec_res_squid <- simulateResiduals(inspect_squid)
plot(inspec_res_squid) # Good(ish)
attack_total_squid <- data_squid %>%
dplyr::group_by(Method,Site, rep_ID,Time, Trophic.group, total_video_min)%>% # sum everything in the replicate by species
dplyr::summarise(attack=sum(attack_number,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Method, Site,rep_ID,Time, total_video_min), fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
inspecting_total_squid <- data_squid %>%
dplyr::group_by(Method, Site, rep_ID,Time, Trophic.group, total_video_min)%>% # sum everything in the replicate by species
dplyr::summarise(inspecting=sum(inspecting_number,na.rm=T)) %>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Method, Site,rep_ID,Time, total_video_min), fill= list(inspecting=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
Omnivore_squid <- attack_total_squid %>%
filter(Trophic.group == "Omnivore")
omn_squid <- glmmTMB(attack   ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data = Omnivore_squid,
family = nbinom2(link = "log"))
Anova(omn_squid) #p<0.00002
omn_attack_res_squid <- simulateResiduals(omn_squid)
plot(omn_attack_res_squid) # This is the best one, but still not good
omn_squid <- glmmTMB(attack   ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data = Omnivore_squid,
family = nbinom2())
Anova(omn_squid) #p<0.00002
omn_attack_res_squid <- simulateResiduals(omn_squid)
plot(omn_attack_res_squid) # This is the best one, but still not good
omn_squid <- glmmTMB(attack   ~ Method + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data = Omnivore_squid,
family = poisson())
Anova(omn_squid) #p<0.00002
omn_attack_res_squid <- simulateResiduals(omn_squid)
plot(omn_attack_res_squid) # This is the best one, but still not good
planktivore_inv <- inspecting_total_squid %>%
filter(Trophic.group == "Planktivore")
plank_inv <- glmmTMB(inspecting  ~ Method + (1|Site) + offset (total_video_min),
data=planktivore_inv,
family = nbinom2())
Anova(plank_inv) # p<0.0001
plank_inv_res_squid <- simulateResiduals(plank_inv)
plot(plank_inv_res_squid) # Good!
plank_inv <- glmmTMB(inspecting  ~ Method + (1|Site) + offset (log(total_video_min)),
data=planktivore_inv,
family = nbinom2())
Anova(plank_inv) # p<0.0001
plank_inv_res_squid <- simulateResiduals(plank_inv)
plot(plank_inv_res_squid) # Good!
plank_inv <- glmmTMB(inspecting  ~ Method + (1|Site) + offset (log(total_video_min)),
data=planktivore_inv,
family = poisson())
Anova(plank_inv) # p<0.0001
plank_inv_res_squid <- simulateResiduals(plank_inv)
plot(plank_inv_res_squid) # Good!
plank_inv <- glmmTMB(inspecting  ~ Method + (1|Site) + offset (total_video_min),
data=planktivore_inv,
family = nbinom1())
Anova(plank_inv) # p<0.0001
plank_inv_res_squid <- simulateResiduals(plank_inv)
plot(plank_inv_res_squid) # Good!
plank_inv <- glmmTMB(inspecting  ~ Method + (1|Site) + offset (total_video_min),
data=planktivore_inv,
family = nbinom2())
Anova(plank_inv) # p<0.0001
plank_inv_res_squid <- simulateResiduals(plank_inv)
plot(plank_inv_res_squid) # Good!
library(tidyverse)
library(dplyr)
library(ggplot2)
library(sp)
library(rgdal)
library(raster)
library(ggpubr)
library(ggspatial)
library(ozmaps)
library(cowplot)
library(car)
library(glmmTMB)
library(DHARMa)
library(here)
sites <- read.csv("data/sites_predation.csv")
city_data <- data.frame(city_name=c("Lizard Island", "Sydney"))
city_data$lat <- c(-14.664354450460095, -33.906516)
city_data$long <- c(145.45703254662746,151.245652)
Lat_predation <- ggplot(data = ozmap(x="states")) +
geom_sf() +
coord_sf(xlim = c(142,157), ylim = c(-40,-10), expand = FALSE)+
geom_point(data=sites, aes(x=Longitude, y=Latitude,
colour = "#d1495b", size=2))+
# scale_color_manual(name="Data_type", values=color_type) +
theme(panel.background = element_rect(fill = "white"),
legend.position = "none",
panel.border = element_rect(colour = "black",fill = NA),
axis.text = element_text(size = (10), colour="black"),
axis.title = element_blank()) + scale_size(guide = "none")+
guides(color = guide_legend(override.aes = list(size = 3) ) )
Lat_predation
Aus <- ggplot(data = ozmap(x="country")) +
geom_sf(color="black", fill= "white") +
geom_rect(xmin = 142, xmax = 156, ymin = -36, ymax = -14,
fill = NA, colour = "black", size = 0.5) +
scale_fill_viridis_d(option = "plasma") +
coord_sf(xlim = c(100.00, 160.00), ylim = c(-45.00, -10.00), expand = TRUE) +
theme_void()
Aus
map <- ggdraw(Lat_predation) +
draw_plot(Aus, x = 0.5, y = 0.8, width = 0.24, height = 0.24)
map
ggsave(map, file=here::here("graphs", "Figure1.jpeg"),
height = 20, width = 18, unit = "cm")
data <- read.csv(here:: here("data/data_predation.csv"))
data_domes <- data %>%
filter (Treatment != "No_fish") %>%
dplyr::select(-Treatment)
attack <- data_domes %>%
dplyr::group_by(Area,Site, Replicate,Time, Trophic.group)%>% # sum everything in the transect by species
dplyr::summarise(attack=sum(attack_hour,na.rm=T))%>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Area, Site, Replicate,Time),fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
inspecting <- data_domes %>%
dplyr::group_by(Area,Site,Replicate,Time,Trophic.group)%>%
dplyr::summarise(inspecting=sum(inspecting_hour,na.rm=T))%>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Area, Site,Replicate,Time),fill= list(inspecting=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
# #Calculate mean
#
attack_toplot<- Rmisc::summarySE(attack, na.rm= T, measurevar=c("attack"),
groupvars=c("Area", "Trophic.group"))
dome_colours <- c(Sydney = "#2660A4", "Lizard Island" = "#DD614A")
mytheme <- theme(panel.background=element_rect(fill="white"), panel.grid.minor = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),axis.line = element_line(size = 1, colour = "black"),
axis.text = element_text(size = (16), color = "black"), axis.title = element_text(size= (18)),
legend.key = element_rect(fill = "white"), legend.text = element_text(size=20),
legend.title = element_blank(), plot.title = element_text(hjust = -0.05, size = 20, face = "bold"))
plot_attack_dome <- ggplot(attack, aes(x=Trophic.group, y=attack, fill=Area)) +
geom_boxplot()+
scale_y_continuous(trans="log1p")+
geom_point(shape = 21, position = position_jitterdodge(jitter.width = 0.1), size = 2) +
scale_fill_manual(name="Area", values=dome_colours) +
labs(x="", y="Attack per hour") +
mytheme + theme(legend.position = "none", axis.text.x = element_text(angle = 45, hjust=1))+
ggtitle(("a)"))
plot_attack_dome
ggsave(plot_attack_dome, file=here::here("graphs/Figure_attack_dome.jpeg"),
height = 16, width = 24, unit = "cm" )
plot_inspection_dome <- ggplot(inspecting,aes(x=Trophic.group, y=inspecting, fill=Area)) +
geom_boxplot()+
scale_y_continuous(trans="log1p", limits = c(0,20), breaks = seq(from=0, to=20, by=5))+
geom_point(shape = 21, position = position_jitterdodge(jitter.width = 0.1), size = 2) +
scale_fill_manual(name="Area", values=dome_colours) +
labs(x="", y="Inspection per hour") +
mytheme +theme(legend.position = "none", axis.text.x = element_text(angle = 45, hjust=1))+
ggtitle(("b)"))
plot_inspection_dome
ggsave(plot_inspection_dome, file=here::here("graphs/Figure_inspection_dome.jpeg"),
height = 16, width = 24, unit = "cm" )
figure_3 <-ggarrange(plot_attack_dome, plot_inspection_dome,
ncol = 2, nrow = 1)
figure_3
ggsave(figure_3, file=here::here("graphs/Figure_3.jpeg"),
height = 16, width = 24, unit = "cm" )
data_domes <- unite(data_domes, rep_ID, c("Site", "Replicate", "Time"), sep = "_", remove = FALSE)
attack_number <- data_domes %>%
dplyr::group_by(Area,Site, rep_ID,Time, total_video_min)%>%
dplyr::summarise(attack=sum(attack_number,na.rm=T))
inspecting_number <- data_domes %>%
dplyr::group_by(Area,Site,rep_ID,Time, total_video_min)%>%
dplyr::summarise(inspecting=sum(inspecting_number,na.rm=T))
domes_attack <- glmmTMB (attack   ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=attack_number, family = poisson())
summary(domes_attack)
Anova(domes_attack) # p=0.28
attack_res_domes <- simulateResiduals(domes_attack)
plot(attack_res_domes) #Good
domes_inspect <- glmmTMB (inspecting ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=inspecting_number, family = nbinom2 ())
summary(domes_inspect)
Anova(domes_inspect) #p = 0.19
inspect_res_domes <- simulateResiduals(domes_inspect)
plot(inspect_res_domes) # Good
attack_total <- data_domes %>%
dplyr::group_by(Area,Site, rep_ID,Time, total_video_min, Trophic.group)%>%
dplyr::summarise(attack=sum(attack_number,na.rm=T))%>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Area, Site, rep_ID,Time, total_video_min),fill= list(attack=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
piscivores <- attack_total %>%
filter(Trophic.group == "Piscivore")
pisc <- glmmTMB (attack ~ Area + (1|Site)+ (1|rep_ID) + offset (log(total_video_min)),
data=piscivores,
family = poisson())
Anova(pisc) #p=0.03
pis_res_domes <- simulateResiduals(pisc)
plot(pis_res_domes) # Good
inspect_total <- data_domes %>%
dplyr::group_by(Area,Site, rep_ID,Time, total_video_min, Trophic.group)%>%
dplyr::summarise(inspect=sum(inspecting_number,na.rm=T))%>%
ungroup%>%
tidyr::complete(Trophic.group, nesting(Area, Site, rep_ID,Time, total_video_min),fill= list(inspect=0)) %>%
replace(is.na(.), 0)%>% # replace the NaN resulting from dividing 0 by 0 for 0
glimpse()
piscivores_inv <- inspect_total %>%
filter(Trophic.group == "Piscivore")
pisc_inv <- glmmTMB(inspect  ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=piscivores_inv,
family = poisson())
summary(pisc_inv)
Anova(pisc_inv) # p= 0.0006
pisc_inv_res_domes <- simulateResiduals(pisc_inv)
plot(pisc_inv_res_domes) #Good
planktivore_inv <- inspect_total %>%
filter(Trophic.group == "Planktivore")
plank_inv <- glmmTMB(inspect ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)), data=planktivore_inv,
family = nbinom1())
Anova(plank_inv) # p=0.8923
plank_inv_res_domes <- simulateResiduals(plank_inv)
plot(plank_inv_res_domes) # Good!
domes_attack <- glmmTMB (attack   ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=attack_number, family = poisson())
summary(domes_attack)
Anova(domes_attack) # p=0.28
domes_inspect <- glmmTMB (inspecting ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=inspecting_number, family = nbinom2 ())
summary(domes_inspect)
Anova(domes_inspect) #p = 0.19
pisc <- glmmTMB (attack ~ Area + (1|Site)+ (1|rep_ID) + offset (log(total_video_min)),
data=piscivores,
family = poisson())
Anova(pisc) #p=0.03
pis_res_domes <- simulateResiduals(pisc)
plot(pis_res_domes) # Good
piscivores_inv <- inspect_total %>%
filter(Trophic.group == "Piscivore")
pisc_inv <- glmmTMB(inspect  ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)),
data=piscivores_inv,
family = poisson())
summary(pisc_inv)
Anova(pisc_inv) # p= 0.0006
planktivore_inv <- inspect_total %>%
filter(Trophic.group == "Planktivore")
plank_inv <- glmmTMB(inspect ~ Area + (1|Site) + (1|rep_ID) + offset (log(total_video_min)), data=planktivore_inv,
family = nbinom1())
Anova(plank_inv) # p=0.8923
